{% extends 'base.html' %}
{% load cart_tags %}
{% block content %}

<h1>Cart</h1>

{% if cart_items %}
  <table class="table">
    <thead>
      <tr>
        <th scope="col">Product Name</th>
        <th scope="col">Quantity</th>
        <th scope="col">Price</th>
        <th scope="col">Total</th>
      </tr>
    </thead>
    <tbody>
      {% for item in cart_items %}
        <tr>
          <td>{{ item.product.name }}</td>
          <td>
            <form method="post" action="{% url 'add_to_cart' item.product.id %}">
              {% csrf_token %}
              <input type="hidden" name="product_id" value="{{ item.product.id }}">
              <div class="form-group">
                <input type="number" name="quantity" id="quantity" class="form-control" value="{{ item.quantity }}" min="1">
              </div>
              <button type="submit" class="btn btn-primary">Update</button>
            </form>
             <div class="col-md-4">
          <form method="post" action="{% url 'remove_from_cart' item.product.id %}">
            {% csrf_token %}
            <input type="hidden" name="item_id" value="{{ item.id }}">
            <button type="submit" class="btn btn-danger">Remove from Cart</button>
          </form>
        </div>
          </td>
          <td>{{ item.product.price }}€</td>
          <td>{{ item.total }}€</td>
        </tr>
      {% endfor %}
      <tr>
        <td colspan="3" class="text-right"><strong>Total:</strong></td>
        <td><strong>{{ total_price }}€</strong></td>
      </tr>
    </tbody>
  </table>

  <!-- Checkout Form -->
  <h2>Checkout</h2>
  <form method="post" action="{% url 'checkout' %}">
    {% csrf_token %}
    <div class="form-group">
      <label for="first-name">First Name:</label>
      <input type="text" name="first-name" id="first-name" class="form-control" required>
    </div>

    <div class="form-group">
      <label for="last-name">Last Name:</label>
      <input type="text" name="last-name" id="last-name" class="form-control" required>
    </div>

    <div class="form-group">
      <label for="address">Address:</label>
      <input type="text" name="address" id="address" class="form-control" required>
    </div>

    <div class="form-group">
      <label for="phone">Phone Number:</label>
      <input type="tel" name="phone" id="phone" class="form-control" required>
    </div>

    <div class="form-group">
      <label for="card-number">Card Number:</label>
      <input type="text" name="card-number" id="card-number" class="form-control" required>
    </div>

    <button type="submit" class="btn btn-primary">Place Order</button>
  </form>

{% else %}
  <p>Your cart is empty.</p>
{% endif %}

{% endblock %}